    <!-- A√±adir este script INMEDIATAMENTE despu√©s del main -->
    <script>
        // Script de inicializaci√≥n TEMPRANA - se ejecuta antes de que el DOM termine de cargar
        (function() {
            // Obtener el idioma guardado
            const savedLang = localStorage.getItem('lang') || 'es';
            
            // Definir traducciones (solo las necesarias para la inicializaci√≥n)
            const initialTranslations = {
                es: {
                    h1: "Libertad Financiera", subtitle: "Tu mapa hacia el retiro anticipado.",
                    labelSpend: "Gasto Mensual ($)", labelCap: "Capital Inicial ($)",
                    labelSave: "Ahorro Mensual ($)", labelRet: "Rentabilidad (%)", panic: "‚ö†Ô∏è CRASH MERCADO",
                    resLabel: "TIEMPO PARA EL RETIRO", metaLabel: "Meta Total"
                },
                en: {
                    h1: "Financial Freedom", subtitle: "Your roadmap to early retirement.",
                    labelSpend: "Monthly Spending ($)", labelCap: "Initial Capital ($)",
                    labelSave: "Monthly Savings ($)", labelRet: "Annual Return (%)", panic: "‚ö†Ô∏è MARKET CRASH",
                    resLabel: "TIME TO RETIRE", metaLabel: "Total Target"
                }
            };
            
            // Si el idioma es ingl√©s, aplicar las traducciones INMEDIATAMENTE
            if (savedLang === 'en' && typeof document !== 'undefined') {
                const t = initialTranslations.en;
                
                // Actualizar elementos visibles r√°pidamente
                const updateElement = (id, text) => {
                    const el = document.getElementById(id);
                    if (el) el.innerText = text;
                };
                
                updateElement('txt-h1', t.h1);
                updateElement('txt-subtitle', t.subtitle);
                updateElement('txt-label-spend', t.labelSpend);
                updateElement('txt-label-cap', t.labelCap);
                updateElement('txt-label-save', t.labelSave);
                updateElement('txt-label-ret', t.labelRet);
                updateElement('txt-panic', t.panic);
                updateElement('txt-res-label', t.resLabel);
                updateElement('txt-meta-label', t.metaLabel);
                
                // Tambi√©n actualizar botones de idioma
                const btnEs = document.getElementById('btn-es');
                const btnEn = document.getElementById('btn-en');
                if (btnEs && btnEn) {
                    btnEs.classList.remove('active');
                    btnEn.classList.add('active');
                }
            }
        })();
    </script>
    
    <article class="seo-article">
        <div id="seo-content">
            <h2>¬øQu√© es el Movimiento FIRE?</h2>
            <p>El movimiento <b>FIRE</b> (Financial Independence, Retire Early) es una estrategia que busca la libertad financiera mediante el ahorro agresivo y la inversi√≥n inteligente. Nuestra calculadora utiliza la <b>Regla del 4%</b> para determinar cu√°ndo tus activos pueden cubrir tus gastos anuales de por vida.</p>
            
            <h3>C√≥mo usar este simulador</h3>
            <p>Introduce tus gastos mensuales actuales y tu capital disponible. Ver√°s c√≥mo el <b>inter√©s compuesto</b> trabaja a tu favor. El gr√°fico muestra la intersecci√≥n entre tus gastos anuales (l√≠nea roja) y tus ingresos pasivos proyectados (l√≠nea azul). Cuando la l√≠nea azul cruza a la roja, eres financieramente libre.</p>
            
            <h3>Riesgo y Volatilidad</h3>
            <p>Los mercados no siempre suben. Por eso hemos incluido el bot√≥n <b>Market Crash</b>, que simula una ca√≠da del 50%. Un plan s√≥lido debe resistir estas volatilidades. Es recomendable mantener un colch√≥n de efectivo para evitar vender activos durante las crisis.</p>

            <section class="faq-section">
                <h3>Preguntas Frecuentes (FAQ)</h3>
                <div class="faq-item">
                    <b>¬øQu√© es la regla del 4%?</b>
                    <p>Es una gu√≠a para determinar cu√°nto puedes retirar de tus inversiones sin agotar tu capital, asumiendo un retiro de 30 a√±os ajustado por inflaci√≥n.</p>
                </div>
                <div class="faq-item">
                    <b>¬øC√≥mo calculo mi Meta FIRE?</b>
                    <p>La forma m√°s r√°pida es multiplicar tus gastos anuales por 25. Ese es el capital necesario para ser libre financieramente.</p>
                </div>
                <div class="faq-item">
                    <b>¬øQu√© papel juega la inflaci√≥n?</b>
                    <p>La inflaci√≥n reduce tu poder de compra. Es vital usar una rentabilidad neta (rentabilidad menos inflaci√≥n) para que los c√°lculos sean realistas.</p>
                </div>
                <div class="faq-item">
                    <b>¬øEs mejor ahorrar m√°s o invertir mejor?</b>
                    <p>Al principio, tu tasa de ahorro es el factor m√°s determinante. Con el tiempo, el inter√©s compuesto hace que la rentabilidad gane peso.</p>
                </div>
            </section>
        </div>
        <div class="ad-placeholder" style="margin-top: 30px;">AD SPACE - BOTTOM</div>
    </article>

    <footer>
        <a href="privacy.html">Privacy</a> | <a href="legal.html">Legal</a> | <a href="cookies.html">Cookies</a>
        <p style="margin-top: 15px;">&copy; 2026 QuickFireCalc.io</p>
    </footer>
</div>

<script>
    let panic = 1;
    let currentLang = localStorage.getItem('lang') || 'es';
    let fireChart;

    const translations = {
        es: {
            h1: "Libertad Financiera", subtitle: "Tu mapa hacia el retiro anticipado.",
            labelSpend: "Gasto Mensual ($)", labelCap: "Capital Inicial ($)",
            labelSave: "Ahorro Mensual ($)", labelRet: "Rentabilidad (%)", panic: "‚ö†Ô∏è CRASH MERCADO",
            resLabel: "TIEMPO PARA EL RETIRO", metaLabel: "Meta Total", free: "¬°LIBRE!",
            chartInc: "Ingresos Pasivos (4%)", chartExp: "Gastos Anuales",
            cookie: "Usamos cookies para mejorar tu experiencia. ",
            article: `<h2>¬øQu√© es el Movimiento FIRE?</h2>
            <p>El movimiento <b>FIRE</b> (Financial Independence, Retire Early) es una estrategia que busca la libertad financiera mediante el ahorro agresivo y la inversi√≥n inteligente. Nuestra calculadora utiliza la <b>Regla del 4%</b> para determinar cu√°ndo tus activos pueden cubrir tus gastos anuales de por vida.</p>
            <h3>C√≥mo usar este simulador</h3>
            <p>Introduce tus gastos mensuales actuales y tu capital disponible. Ver√°s c√≥mo el <b>inter√©s compuesto</b> trabaja a tu favor. El gr√°fico muestra la intersecci√≥n entre tus gastos anuales (l√≠nea roja) y tus ingresos pasivos proyectados (l√≠nea azul). Cuando la l√≠nea azul cruza a la roja, eres financieramente libre.</p>
            <h3>Riesgo y Volatilidad</h3>
            <p>Los mercados no siempre suben. Por eso hemos incluido el bot√≥n <b>Market Crash</b>, que simula una ca√≠da del 50%. Un plan s√≥lido debe resistir estas volatilidades. Es recomendable mantener un colch√≥n de efectivo para evitar vender activos durante las crisis.</p>
            <section class="faq-section">
                <h3>Preguntas Frecuentes (FAQ)</h3>
                <div class="faq-item">
                             <b>¬øQu√© es la regla del 4%?</b>
                    <p>
        La <strong>regla del 4%</strong> es una de las piedras angulares del movimiento FIRE y se utiliza para determinar la 
        <strong>tasa de retiro segura</strong> durante la jubilaci√≥n. Su origen se encuentra en el c√©lebre 
        <strong>Estudio Trinity</strong> (1998), donde tres profesores de la Universidad de Trinity analizaron datos 
        hist√≥ricos de los mercados financieros para encontrar cu√°nto dinero podr√≠a retirar un jubilado de su 
        cartera sin agotar sus ahorros prematuramente.
    </p>
    <p>
        En t√©rminos sencillos, la regla establece que si inviertes tus ahorros en una combinaci√≥n equilibrada de 
        acciones y bonos, puedes retirar el <strong>4% de tu capital total durante el primer a√±o</strong> de retiro. 
        Para los a√±os siguientes, simplemente ajustas esa cantidad inicial seg√∫n la inflaci√≥n, independientemente 
        de si el mercado ha subido o bajado. Siguiendo este m√©todo, el estudio demostr√≥ que existe una probabilidad 
        superior al <strong>95%</strong> de que tu patrimonio dure al menos 30 a√±os en la mayor√≠a de los escenarios hist√≥ricos.
    </p>
    <p>
        Por ejemplo, si tu meta es acumular <strong>$600,000</strong>, el primer a√±o podr√≠as retirar <strong>$24,000</strong>. 
        Si la inflaci√≥n ese a√±o es del 3%, el segundo a√±o retirar√≠as $24,720, y as√≠ sucesivamente. Esta regla 
        es extremadamente √∫til porque permite calcular r√°pidamente tu "N√∫mero FIRE": solo necesitas multiplicar 
        tus gastos anuales deseados por 25. Aunque es una gu√≠a excelente, es importante revisarla peri√≥dicamente 
        para adaptarse a contextos de rentabilidades bajas o inflaciones excepcionalmente altas.
    </p>
                </div>
                <div class="faq-item">
                    <b>¬øC√≥mo calculo mi Meta FIRE?</b>
                    <p>La forma m√°s r√°pida es multiplicar tus gastos anuales por 25. Ese es el capital necesario para ser libre financieramente.</p>
                </div>
                <div class="faq-item">
                    <b>¬øQu√© papel juega la inflaci√≥n?</b>
                    <p>La inflaci√≥n reduce tu poder de compra. Es vital usar una rentabilidad neta (rentabilidad menos inflaci√≥n) para que los c√°lculos sean realistas.</p>
                </div>
                <div class="faq-item">
                    <b>¬øEs mejor ahorrar m√°s o invertir mejor?</b>
                    <p>Al principio, tu tasa de ahorro es el factor m√°s determinante. Con el tiempo, el inter√©s compuesto hace que la rentabilidad gane peso.</p>
                </div>
            </section>`
        },
        en: {
            h1: "Financial Freedom", subtitle: "Your roadmap to early retirement.",
            labelSpend: "Monthly Spending ($)", labelCap: "Initial Capital ($)",
            labelSave: "Monthly Savings ($)", labelRet: "Annual Return (%)", panic: "‚ö†Ô∏è MARKET CRASH",
            resLabel: "TIME TO RETIRE", metaLabel: "Total Target", free: "FREE!",
            chartInc: "Passive Income (4%)", chartExp: "Annual Expenses",
            cookie: "We use cookies to improve your experience. ",
            article: `<h2>What is the FIRE Movement?</h2>
            <p>The <b>FIRE</b> (Financial Independence, Retire Early) movement is a strategy that seeks financial freedom through aggressive saving and smart investing. Our calculator uses the <b>4% Rule</b> to determine when your assets can cover your annual expenses for life.</p>
            <h3>How to use this simulator</h3>
            <p>Enter your current monthly expenses and your available capital. You'll see how <b>compound interest</b> works in your favor. The chart shows the intersection between your annual expenses (red line) and your projected passive income (blue line). When the blue line crosses the red line, you are financially free.</p>
            <h3>Risk and Volatility</h3>
            <p>Markets don't always go up. That's why we've included the <b>Market Crash</b> button, which simulates a 50% drop. A solid plan must withstand these volatilities. It is advisable to maintain a cash cushion to avoid selling assets during market downturns.</p>
            <section class="faq-section">
                <h3>Frequently Asked Questions (FAQ)</h3>
                <div class="faq-item">
                    <b>What is the 4% rule and how does it work?</b>
                    <p>The <strong>4% rule</strong> is a cornerstone of the FIRE movement and is used to determine the <strong>safe withdrawal rate</strong> during retirement. Its origin lies in the famous <strong>Trinity Study</strong> (1998), where historical data was analyzed to find how much money a retiree could withdraw without running out of savings.</p>
                    <p>It states that you can withdraw <strong>4% of your total capital during the first year</strong> of retirement and adjust the figure for inflation in subsequent years. Following this method, there is a greater than <strong>95%</strong> probability that your wealth will last at least 30 years.</p>
                </div>
                <div class="faq-item">
                    <b>How do I calculate my FIRE Goal?</b>
                    <p>The fastest way is to multiply your annual expenses by 25. This is the capital needed to be financially free.</p>
                </div>
                <div class="faq-item">
                    <b>What role does inflation play?</b>
                    <p>Inflation reduces your purchasing power. It is vital to use a net return (return minus inflation) to make the calculations realistic.</p>
                </div>
                <div class="faq-item">
                    <b>Is it better to save more or invest better?</b>
                    <p>At the beginning, your savings rate is the most determining factor. Over time, compound interest makes investment returns more significant.</p>
                </div>
            </section>`
        }
    };

    function toggleDarkMode() {
        const body = document.getElementById('body');
        const icon = document.getElementById('theme-icon');
        const isDark = body.classList.toggle('dark-mode');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        icon.innerText = isDark ? '‚òÄÔ∏è' : 'üåô';
        if(fireChart) {
            const color = isDark ? '#94a3b8' : '#64748b';
            fireChart.options.scales.x.ticks.color = color;
            fireChart.options.scales.y.ticks.color = color;
            fireChart.update();
        }
    }

    function initChart() {
        const ctx = document.getElementById('fireChart').getContext('2d');
        const isDark = document.body.classList.contains('dark-mode') || window.matchMedia('(prefers-color-scheme: dark)').matches;
        const color = isDark ? '#94a3b8' : '#64748b';

        fireChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    { label: '', data: [], borderColor: '#2563eb', backgroundColor: 'rgba(37, 99, 235, 0.05)', fill: true, tension: 0.4, borderWidth: 3, pointRadius: 0 },
                    { label: '', borderColor: '#ef4444', borderDash: [5, 5], fill: false, borderWidth: 2, pointRadius: 0 }
                ]
            },
            options: { 
                responsive: true, maintainAspectRatio: false,
                scales: {
                    y: { ticks: { color: color } },
                    x: { ticks: { color: color } }
                }
            }
        });
    }

    function calculate() {
        const t = translations[currentLang];
        const spend = (parseFloat(document.getElementById('spend').value) || 0) * 12;
        const cap = (parseFloat(document.getElementById('capital').value) || 0) * panic;
        const save = parseFloat(document.getElementById('save').value) || 0;
        const rate = (parseFloat(document.getElementById('return').value) || 0) / 100;
        const target = spend * 25;

        document.getElementById('fi-ratio').innerText = target > 0 ? Math.min((cap/target)*100, 100).toFixed(1) + "%" : "0%";
        document.getElementById('target-val').innerText = "$" + target.toLocaleString();

        let labels = [], dInc = [], dExp = [], tCap = cap;
        for (let y = 0; y <= 40; y++) {
            labels.push(y); dExp.push(spend); dInc.push(Math.round(tCap * 0.04));
            for(let m = 0; m < 12; m++) tCap = (tCap + save) * (1 + (rate/12));
        }

        let months = 0, cCap = cap;
        if ((save*12 + cCap*rate) > 0) {
            while(cCap < target && months < 1200) { cCap = (cCap + save) * (1 + (rate/12)); months++; }
        }

        const yrs = Math.floor(months / 12), mths = months % 12;
        document.getElementById('fire-date').innerText = cap >= target ? t.free : (months >= 1200 ? "‚àû" : `${yrs}${currentLang==='es'?'a':'y'} ${mths}m`);
        
        fireChart.data.labels = labels;
        fireChart.data.datasets[0].data = dInc;
        fireChart.data.datasets[0].label = t.chartInc;
        fireChart.data.datasets[1].data = dExp;
        fireChart.data.datasets[1].label = t.chartExp;
        fireChart.update('none');
    }

    function switchLang(lang) {
        currentLang = lang;
        localStorage.setItem('lang', lang);
        const t = translations[lang];
        document.getElementById('txt-h1').innerText = t.h1;
        document.getElementById('txt-subtitle').innerText = t.subtitle;
        document.getElementById('txt-label-spend').innerText = t.labelSpend;
        document.getElementById('txt-label-cap').innerText = t.labelCap;
        document.getElementById('txt-label-save').innerText = t.labelSave;
        document.getElementById('txt-label-ret').innerText = t.labelRet;
        document.getElementById('txt-panic').innerText = t.panic;
        document.getElementById('txt-res-label').innerText = t.resLabel;
        document.getElementById('txt-meta-label').innerText = t.metaLabel;
        document.getElementById('seo-content').innerHTML = t.article;
        document.getElementById('btn-es').classList.toggle('active', lang === 'es');
        document.getElementById('btn-en').classList.toggle('active', lang === 'en');
        calculate();
    }

    function applyPanic() { panic = 0.5; document.getElementById('reset-btn').style.display = 'block'; calculate(); }
    function resetPanic() { panic = 1; document.getElementById('reset-btn').style.display = 'none'; calculate(); }
    function acceptCookies() { document.getElementById('cookie-banner').style.display = 'none'; localStorage.setItem('fire-cookies', '1'); }

    window.onload = () => {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.getElementById('body').classList.add('dark-mode');
            document.getElementById('theme-icon').innerText = '‚òÄÔ∏è';
        }
        
        // Aplicar el idioma guardado - ahora solo actualizar√° contenido no visible a√∫n
        const savedLang = localStorage.getItem('lang') || 'es';
        currentLang = savedLang;
        
        // Solo actualizar contenido que a√∫n no fue actualizado (como el art√≠culo SEO)
        const t = translations[currentLang];
        document.getElementById('seo-content').innerHTML = t.article;
        document.getElementById('cookie-text').innerHTML = t.cookie + '<a href="privacy.html" style="color: var(--secondary);">Info</a>';
        document.getElementById('btn-es').classList.toggle('active', savedLang === 'es');
        document.getElementById('btn-en').classList.toggle('active', savedLang === 'en');
        
        if(localStorage.getItem('fire-cookies')) document.getElementById('cookie-banner').style.display = 'none';
        
        initChart();
        calculate();
    };
</script>
</body>
</html>
